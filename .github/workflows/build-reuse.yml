name: a1

on:
  workflow_dispatch:
    inputs:
      run_ons:
        description: 'OS list'
        required: true
        default: '["windows-2019", "macos-10.15"]'

env:
  _GITHUB_PAT: ${{secrets._GITHUB_PAT}}
  JIRA_PROJECT: ${{secrets.TEST_JIRA_PROJECT}}
  JIRA_API_TOKEN: ${{secrets.JIRA_API_TOKEN}}

jobs:
  make-reuse:
    strategy:
      matrix:
        os: ${{fromJson(github.event.inputs.run_ons)}}
    runs-on: ${{matrix.os}}

    steps:
      - uses: actions/checkout@v2
      - uses: ./.github/actions/setup-preclone-env

      - shell: powershell
        run: |
          Compress-Archive `
            -Path "./src", "./.github" `
            -CompressionLevel "Fastest" `
            -DestinationPath "./abc.zip"
          get-childitem "." -recurse -force | where-object { $_.FullName.Length -ge 256 } | select-object FullName | format-list
