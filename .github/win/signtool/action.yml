#inputs:
#  name:
#    description: 'Your name'
#    default: 'No name provided'

name: detect signtool.exe
description: auto detect signtool.exe installed in GHA windows runner

runs:
  using: "composite"
  steps:
    - name: export sign cert pfx file
      shell: bash
      working-directory: .github/tools
      run: |
        $SIGNTOOL_B64="wincodesign.b64"
        $SIGNTOOL_PFX="wincodesign.pfx"

        certutil -decode $SIGNTOOL_B64 $SIGNTOOL_PFX
        certutil -f -user -p "${{secrets.WIN_CODESIGN_PASSWORD}}" -importpfx $SIGNTOOL_PFX NoRoot

        $SIGNTOOL_PFX=(Resolve-Path -Path $SIGNTOOL_PFX | foreach { $_.Path })
        echo "SIGNTOOL_PFX=$SIGNTOOL_PFX" >> $GITHUB_ENV

#runs:
#  using: "composite"
#  steps:
#    - name: detect signtool.exe
#      shell: bash
#      run: |
#        node ./.github/js/test.js

##    - name: debug
##      shell: bash
##      run: |
##        echo 123
##        echo ${{steps.signtool_exe.outputs.SIGNTOOL_EXE}}
##        signtool xxx
